"use strict";var arr=[2016,2017,2018,2019,2020,2021,2022,2023,2024],top5=[{name:"四川省",value:"52.2"},{name:"贵州省",value:"10.4"},{name:"湖北省",value:"7.2"},{name:"湖南省",value:"5.1"},{name:"云南",value:"4.2"}],chinaDatas2=[[{name:"陕西",value:82},{name:"重庆"}],[{name:"青海",value:54},{name:"重庆"}],[{name:"西藏",value:44},{name:"重庆"}],[{name:"四川",value:33},{name:"重庆"}],[{name:"湖北",value:78},{name:"重庆"}],[{name:"湖南",value:33},{name:"重庆"}],[{name:"贵州",value:44},{name:"重庆"}],[{name:"内蒙古",value:44},{name:"重庆"}]],argeRateData={x:[0,10,20,30,40,50,60,70],y1:[20,30,70,60,42,33,12,5],y2:[20,30,70,60,42,33,12,5]},educationData=[{name:"研究生及以上",value:"1.2%"},{name:"本科",value:"8.2%"},{name:"大专",value:"10.8%"},{name:"中专/职高",value:"12.2%"},{name:"高中",value:"16.6%"},{name:"初中",value:"40.6%"},{name:"小学",value:"9.6%"},{name:"未知",value:"6%"}];function timelineHandle(e){for(var a=[],t=0;t<e.length;t++){var n="<li>"+e[t]+"</li>";a.push(n)}$(".timeline").html(a.join("")),$(".timeline").off("click","li").on("click","li",function(){$(this).siblings("li").removeClass("active"),$(this).addClass("active");$(this).text();changeQuarter()}),$(".timeline").find("li").eq(0).trigger("click")}function setTopFiveMeg(e){for(var a=[],t=0;t<e.length;t++){var n='<div class="data-screen-content-cell" style="padding:20px 0">\n       <div class="data-screen-key">\n               <span class="data-screen-key-icon" style="opacity:'+(1-t/10*2)+';">'+(t+1)+"</span>\n           <span>"+e[t].name+'</span>\n       </div>\n       <div class="data-screen-value">\n       '+e[t].value+"万人\n       </div>\n   </div>";a.push(n)}$(".top5").empty().html(a.join(""))}function loadMigrationChinaChart(n){var i=echarts.init(document.getElementById("migrationChinaChart"));i.showLoading(),$.getJSON("../json/china.json",function(e){echarts.registerMap("china",e);var l={"黑龙江":[127.9688,45.368],"内蒙古":[110.3467,41.4899],"吉林":[125.8154,44.2584],"北京市":[116.4551,40.2539],"辽宁":[123.1238,42.1216],"河北":[114.4995,38.1006],"天津":[117.4219,39.4189],"山西":[112.3352,37.9413],"陕西":[109.1162,34.2004],"甘肃":[103.5901,36.3043],"宁夏":[106.3586,38.1775],"青海":[101.4038,36.8207],"新疆":[87.9236,43.5883],"西藏":[91.11,29.97],"四川":[103.9526,30.7617],"重庆":[108.384366,30.439702],"山东":[117.1582,36.8701],"河南":[113.4668,34.6234],"江苏":[118.8062,31.9208],"安徽":[117.29,32.0581],"湖北":[114.3896,30.6628],"浙江":[119.5313,29.8773],"福建":[119.4543,25.9222],"江西":[116.0046,28.6633],"湖南":[113.0823,28.2568],"贵州":[106.6992,26.7682],"云南":[102.9199,25.4663],"广东":[113.12244,23.009505],"广西":[108.479,23.1152],"海南":[110.3893,19.8516],"上海":[121.4648,31.2891]},t=[];[["重庆",n]].forEach(function(e,a){t.push({name:"连线",type:"lines",zlevel:2,effect:{show:!0,period:6,trailLength:.8,symbol:"arrow",symbolSize:5,color:"#FF5902"},lineStyle:{normal:{color:"#FFD756",width:1,opacity:1,curveness:.3}},data:function(e){for(var a=[],t=0;t<e.length;t++){var n=e[t],i=l[n[0].name],o=l[n[1].name];i&&o&&a.push({fromName:n[0].name,toName:n[1].name,coords:[i,o],value:n[0].value||n[1].value})}return a}(e[1])},{name:"出发点",type:"effectScatter",coordinateSystem:"geo",zlevel:2,rippleEffect:{period:6,brushType:"stroke",scale:4,color:"#FFDA57"},label:{normal:{show:!0,position:"right",offset:[10,0],formatter:function(e){return e.data.name},fontSize:13,color:"#48A09F"},emphasis:{show:!0}},symbol:"circle",symbolSize:function(e){return e[2]/5},itemStyle:{normal:{show:!1,color:"#FFDA57"}},data:e[1].map(function(e){return{name:e[0].name,value:l[e[0].name].concat([e[0].value])}})},{name:"目的地",type:"scatter",coordinateSystem:"geo",zlevel:2,rippleEffect:{period:20,brushType:"stroke",scale:2,color:"#FFA93D"},label:{normal:{show:!0,position:"right",formatter:"{b}",textStyle:{color:"#FFD756"}}},itemStyle:{},symbolSize:20,data:[{name:e[0],value:l[e[0]].concat([10])}],formatter:"{b}"})});var a={tooltip:{trigger:"item",backgroundColor:"rgba(0, 0,0, 0.82)",showDelay:0,hideDelay:0,enterable:!0,transitionDuration:0,extraCssText:"z-index:100",formatter:function(e,a,t){return"effectScatter"==e.seriesType?e.data.name+"："+e.data.value[2]+"万人":"lines"==e.seriesType?e.data.fromName+"迁移到"+e.data.toName+"<br />人口数:"+e.data.value+"万人":e.name}},geo:{map:"china",zoom:1.2,label:{emphasis:{show:!1}},roam:!0,itemStyle:{normal:{areaColor:"#143841",borderColor:"#489099",borderWidth:1},emphasis:{color:"#254751"}},regions:[{name:"重庆市",itemStyle:{areaColor:"#FFDA57"}}]},series:t};i.hideLoading(),i.setOption(a),i.on("click",function(e){})})}function loadMigrationAgeChart(e){var a=e.y2.slice();a.sort(function(e,a){return a-e}),console.log("y2copy",a);var t=echarts.init($("#migrationAgeChart")[0]),n={title:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",showDelay:0,formatter:function(e){return e[0].seriesName+" :"+e[0].value+" 万人<br>"+e[1].seriesName+" :"+e[0].value+"% "},axisPointer:{show:!1,type:"cross",lineStyle:{type:"dashed",width:1}}},legend:{data:e.label,left:"center",textStyle:{color:"#5891A2",fontSize:"16"}},xAxis:[{type:"category",scale:!0,axisLabel:{textStyle:{color:"#03B4E3"}},name:"年龄段",nameTextStyle:{color:"#03B4E3"},axisTick:{lineStyle:{color:"#03B4E3"}},axisLine:{lineStyle:{color:"#03B4E3"}},splitLine:{show:!1,lineStyle:{type:"dashed"}},data:e.x}],yAxis:[{type:"value",scale:!0,name:"(万人)",nameTextStyle:{color:"#03B4E3"},yAxisIndex:0,axisLabel:{textStyle:{color:"#03B4E3"}},axisTick:{lineStyle:{color:"#03B4E3"}},axisLine:{lineStyle:{color:"#03B4E3"}},splitLine:{show:!1,lineStyle:{type:"dashed"}}},{type:"value",scale:!0,name:"百分比",min:a[a.length-1],max:a[0],interval:Math.ceil(a[0]/a.length),nameTextStyle:{color:"#03B4E3"},axisLabel:{formatter:"{value} %",textStyle:{color:"#03B4E3"}},yAxisIndex:1,axisTick:{lineStyle:{color:"#03B4E3"}},axisLine:{lineStyle:{color:"#03B4E3"}},splitLine:{show:!1,lineStyle:{type:"dashed"}}}],series:[{name:"占迁移人口比重",type:"line",data:e.y2,itemStyle:{normal:{color:"#FFDB6D"}}},{name:"预测人口",type:"bar",barWidth:"60%",data:e.y1,itemStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#2ABFF8"},{offset:1,color:"#0294EE"}],!1)}}}]};t.setOption(n)}function setEducationRate(e){for(var a=[],t=0;t<e.length;t++){var n=' <div class="education-rate-item">\n        <div class="title">'+e[t].name+'</div>\n        <div class="progress-container">\n            <div class="progress" style="width:'+e[t].value+'"></div>\n        </div>\n        <div class="label">'+e[t].value+"</div>\n        </div>";a.push(n)}$(".education-rate").empty().html(a.join(""))}function setImmigrationTotal(e){$("#immigrationTotal").empty().html(e+"万")}function changeQuarter(){$(".top-btn-group").off("click").on("click",".change_date_btn",function(){$(this).siblings(".change_date_btn").removeClass("active"),$(this).addClass("active"),chartReLoad()}),$(".top-btn-group").find(".change_date_btn").eq(0).trigger("click")}function chartReLoad(){loadMigrationChinaChart(chinaDatas2),loadMigrationAgeChart(argeRateData),setTopFiveMeg(top5),setEducationRate(educationData),setImmigrationTotal("200")}$(function(){timelineHandle(arr)});